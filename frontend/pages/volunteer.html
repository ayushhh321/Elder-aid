<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volunteer Dashboard - Elderly Assistance Portal</title>
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/volunteer-dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f9f9f9;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #4e73df;
            padding: 1rem;
            color: white;
        }

        .navbar .logo a {
            display: flex;
            align-items: center;
            color: white;
            text-decoration: none;
        }

        .logo img {
            height: 40px;
            margin-right: 10px;
        }

        .logout-btn {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
        }

        .dashboard-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h2, h3 {
            color: #4e73df;
        }

        .task-list {
            margin-top: 1rem;
        }

        .task-card {
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #eef2ff;
        }

        .task-card button {
            margin-top: 0.5rem;
        }

        button {
            padding: 0.8rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .accept-btn {
            background-color: #4CAF50;
            color: white;
        }

        .reject-btn {
            background-color: #f44336;
            color: white;
        }

        @media (max-width: 768px) {
            .dashboard-container {
                grid-template-columns: 1fr;
            }

            .navbar {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="../pages/index.html">
                    <img src="../images/logo-placeholder.png" alt="Elderly Assistance Portal Logo">
                    <h1>Elderly Assistance Portal</h1>
                </a>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </nav>
    </header>

    <main class="dashboard-container">
        <section class="profile-section">
            <h2>Welcome, <span id="volunteerName">Volunteer</span></h2>
            <p><strong>Skills:</strong> <span id="volunteerSkills">--</span></p>
            <p><strong>Location:</strong> <span id="volunteerLocation">--</span></p>
            <p><strong>Availability:</strong> <span id="volunteerAvailability">--</span></p>
            <p><strong>Payment Rate:</strong> <span id="volunteerPayment">--</span></p>
        </section>

        <section class="task-section">
            <h3>Available Tasks</h3>
            <div id="taskList" class="task-list">No tasks available yet.</div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Elderly Assistance Portal. All rights reserved.</p>
    </footer>

    <script src="dashboard.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const volunteerId = 'volunteer-id'; // Replace with actual volunteer ID

            async function fetchVolunteerData() {
                try {
                    const response = await fetch(`http://localhost:3000/api/volunteer/${volunteerId}`);
                    const volunteerData = await response.json();

                    document.getElementById('volunteerName').textContent = volunteerData.name;
                    document.getElementById('volunteerSkills').textContent = volunteerData.skills;
                    document.getElementById('volunteerLocation').textContent = volunteerData.location;
                    document.getElementById('volunteerAvailability').textContent = volunteerData.availability;
                    document.getElementById('volunteerPayment').textContent = volunteerData.paymentRate || '--';
                } catch (error) {
                    console.error('Error fetching volunteer data:', error);
                }
            }

            async function fetchTasks() {
                try {
                    const response = await fetch('http://localhost:3000/api/tasks');
                    const tasks = await response.json();

                    const taskList = document.getElementById('taskList');
                    taskList.innerHTML = tasks.length === 0
                        ? 'No tasks available.'
                        : tasks.map(task => `
                            <div class="task-card">
                                <p><strong>Help Needed:</strong> ${task.helpType}</p>
                                <p><strong>Urgency:</strong> ${task.urgency}</p>
                                <p><strong>Location:</strong> ${task.location}</p>
                                <button class="accept-btn" onclick="acceptTask('${task._id}')">Accept</button>
                                <button class="reject-btn" onclick="rejectTask('${task._id}')">Reject</button>
                            </div>
                        `).join('');
                } catch (error) {
                    console.error('Error fetching tasks:', error);
                }
            }
            window.acceptTask = async (taskId) => {
    try {
        const volunteerId = 'volunteer-id'; // Replace with actual volunteer ID
        const response = await fetch(`http://localhost:3000/api/tasks/${taskId}/accept`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ volunteerId }),
        });

        if (!response.ok) throw new Error('Failed to accept task');

        alert(`Task ${taskId} accepted!`);
        fetchTasks(); // Refresh task list
    } catch (error) {
        console.error('Error accepting task:', error);
        alert('Error accepting task.');
    }
};

window.rejectTask = async (taskId) => {
    alert(`Task ${taskId} rejected.`);
};

            window.logout = () => {
                alert('Logged out successfully.');
                window.location.href = '../pages/index.html';
            };

            await fetchVolunteerData();
            await fetchTasks();
        });
    </script>
</body>

</html> -->



<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volunteer Dashboard - Elderly Assistance Portal</title>
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="../css/volunteer-dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-color: #f9f9f9;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #4e73df;
            padding: 1rem;
            color: white;
        }

        .navbar .logo a {
            display: flex;
            align-items: center;
            color: white;
            text-decoration: none;
        }

        .logo img {
            height: 40px;
            margin-right: 10px;
        }

        .logout-btn {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
        }

        .dashboard-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        section {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h2, h3 {
            color: #4e73df;
        }

        .task-list {
            margin-top: 1rem;
        }

        .task-card {
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #eef2ff;
        }

        .task-card button {
            margin-top: 0.5rem;
        }

        button {
            padding: 0.8rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .accept-btn {
            background-color: #4CAF50;
            color: white;
        }

        .reject-btn {
            background-color: #f44336;
            color: white;
        }

        @media (max-width: 768px) {
            .dashboard-container {
                grid-template-columns: 1fr;
            }

            .navbar {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="../pages/index.html">
                    <img src="../images/logo-placeholder.png" alt="Elderly Assistance Portal Logo">
                    <h1>Elderly Assistance Portal</h1>
                </a>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </nav>
    </header>

    <main class="dashboard-container">
        <section class="profile-section">
            <h2>Welcome, <span id="volunteerName">Volunteer</span></h2>
            <p><strong>Skills:</strong> <span id="volunteerSkills">--</span></p>
            <p><strong>Location:</strong> <span id="volunteerLocation">--</span></p>
            <p><strong>Availability:</strong> <span id="volunteerAvailability">--</span></p>
            <p><strong>Payment Rate:</strong> <span id="volunteerPayment">--</span></p>
        </section>

        <section class="task-section">
            <h3>Available Tasks</h3>
            <div id="taskList" class="task-list">No tasks available yet.</div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Elderly Assistance Portal. All rights reserved.</p>
    </footer>

    <script>
        // document.addEventListener('DOMContentLoaded', async () => {
        //     // Get Volunteer ID from localStorage after login
        //     const volunteerId = localStorage.getItem('userId');

        //     // Redirect to login if not authenticated
        //     if (!volunteerId) {
        //         alert('Unauthorized access. Redirecting to login.');
        //         window.location.href = '../pages/loginPage.html';
        //         return;
        //     }

        //     // Fetch Volunteer Data
        //     async function fetchVolunteerData() {
        //         try {
        //             const response = await fetch(`http://localhost:3000/api/users/${volunteerId}`);
        //             if (!response.ok) throw new Error('Failed to fetch volunteer data');

        //             const volunteerData = await response.json();
        //             document.getElementById('volunteerName').textContent = volunteerData.name;
        //             document.getElementById('volunteerSkills').textContent = volunteerData.skills || '--';
        //             document.getElementById('volunteerLocation').textContent = volunteerData.location || '--';
        //             document.getElementById('volunteerAvailability').textContent = volunteerData.availability || '--';
        //             document.getElementById('volunteerPayment').textContent = volunteerData.paymentRate || '--';
        //         } catch (error) {
        //             console.error('Error fetching volunteer data:', error);
        //         }
        //     }

        //     // Fetch Available Tasks (Only pending)
        //     async function fetchTasks() {
        //         try {
        //             const response = await fetch('http://localhost:3000/api/tasks/pending');
        //             if (!response.ok) throw new Error('Failed to fetch tasks');

        //             const tasks = await response.json();
        //             const taskList = document.getElementById('taskList');
        //             taskList.innerHTML = tasks.length === 0
        //                 ? 'No tasks available.'
        //                 : tasks.map(task => `
        //                     <div class="task-card">
        //                         <p><strong>Help Needed:</strong> ${task.helpType}</p>
        //                         <p><strong>Urgency:</strong> ${task.urgency}</p>
        //                         <p><strong>Location:</strong> ${task.location}</p>
        //                         <button class="accept-btn" onclick="acceptTask('${task._id}')">Accept</button>
        //                         <button class="reject-btn" onclick="rejectTask('${task._id}')">Reject</button>
        //                     </div>
        //                 `).join('');
        //         } catch (error) {
        //             console.error('Error fetching tasks:', error);
        //         }
        //     }

        //     // Accept Task
        //     window.acceptTask = async (taskId) => {
        //         try {
        //             const response = await fetch(`http://localhost:3000/api/tasks/${taskId}/accept`, {
        //                 method: 'PUT',
        //                 headers: { 'Content-Type': 'application/json' },
        //                 body: JSON.stringify({ volunteerId }),
        //             });

        //             if (!response.ok) throw new Error('Failed to accept task');
        //             alert('Task accepted successfully!');
        //             fetchTasks();
        //         } catch (error) {
        //             alert('Error accepting task.');
        //         }
        //     };

        //     // Reject Task
        //     window.rejectTask = async (taskId) => {
        //         alert('Task rejected successfully.');
        //     };

        //     window.logout = () => {
        //         localStorage.removeItem('volunteerId');
        //         window.location.href = '../pages/index.html';
        //     };

        //     await fetchVolunteerData();
        //     await fetchTasks();
        // });
//         document.addEventListener('DOMContentLoaded', async () => {
//     // Get Volunteer ID from localStorage after login
//     const volunteerId = localStorage.getItem('userId');

//     // Redirect to login if not authenticated
//     if (!volunteerId) {
//         alert('Unauthorized access. Redirecting to login.');
//         window.location.href = '../pages/loginPage.html';
//         return;
//     }

//     // Fetch Volunteer Data
//     async function fetchVolunteerData() {
//         try {
//             const response = await fetch(`http://localhost:3000/api/users/${volunteerId}`);
//             if (!response.ok) throw new Error('Failed to fetch volunteer data');

//             const volunteerData = await response.json();
//             document.getElementById('volunteerName').textContent = volunteerData.name;
//             document.getElementById('volunteerSkills').textContent = volunteerData.skills || '--';
//             document.getElementById('volunteerLocation').textContent = volunteerData.location || '--';
//             document.getElementById('volunteerAvailability').textContent = volunteerData.availability || '--';
//             document.getElementById('volunteerPayment').textContent = volunteerData.paymentRate || '--';
//         } catch (error) {
//             console.error('Error fetching volunteer data:', error);
//         }
//     }

//     // Fetch Available Tasks (Only pending)
//     async function fetchTasks() {
//         try {
//             const response = await fetch('http://localhost:3000/api/tasks/pending');
//             if (!response.ok) throw new Error('Failed to fetch tasks');

//             const tasks = await response.json();
//             const taskList = document.getElementById('taskList');
//             taskList.innerHTML = tasks.length === 0
//                 ? 'No tasks available.'
//                 : tasks.map(task => `
//                     <div class="task-card">
//                         <p><strong>Help Needed:</strong> ${task.helpType}</p>
//                         <p><strong>Urgency:</strong> ${task.urgency}</p>
//                         <p><strong>Location:</strong> ${task.location}</p>
//                         <button class="accept-btn" onclick="acceptTask('${task._id}')">Accept</button>
//                         <button class="reject-btn" onclick="rejectTask('${task._id}')">Reject</button>
//                     </div>
//                 `).join('');
//         } catch (error) {
//             console.error('Error fetching tasks:', error);
//         }
//     }

//     // Accept Task
//     window.acceptTask = async (taskId) => {
//         try {
//             const response = await fetch(`http://localhost:3000/api/tasks/${taskId}/accept`, {
//                 method: 'PUT',
//                 headers: { 'Content-Type': 'application/json' },
//                 body: JSON.stringify({ volunteerId }),
//             });

//             if (!response.ok) throw new Error('Failed to accept task');
//             alert('Task accepted successfully!');
//             fetchTasks();
//         } catch (error) {
//             alert('Error accepting task.');
//         }
//     };

//     // Reject Task
//     window.rejectTask = async (taskId) => {
//         alert('Task rejected successfully.');
//     };

//     window.logout = () => {
//         localStorage.removeItem('userId');
//         window.location.href = '../pages/index.html';
//     };

//     await fetchVolunteerData();
//     await fetchTasks();

// });




// volunteer.html script

document.addEventListener('DOMContentLoaded', async () => {
    // Get Volunteer ID from localStorage after login
    const volunteerId = localStorage.getItem('userId');

    // Redirect to login if not authenticated
    if (!volunteerId) {
        alert('Unauthorized access. Redirecting to login.');
        window.location.href = '../pages/loginPage.html';
        return;
    }

    // Fetch Volunteer Data
    async function fetchVolunteerData() {
        try {
            const response = await fetch(`http://localhost:3000/api/users/${volunteerId}`);
            if (!response.ok) throw new Error('Failed to fetch volunteer data');

            const volunteerData = await response.json();
            document.getElementById('volunteerName').textContent = volunteerData.name;
            document.getElementById('volunteerSkills').textContent = volunteerData.skills || '--';
            document.getElementById('volunteerLocation').textContent = volunteerData.location || '--';
            document.getElementById('volunteerAvailability').textContent = volunteerData.availability || '--';
            document.getElementById('volunteerPayment').textContent = volunteerData.paymentRate || '--';
        } catch (error) {
            console.error('Error fetching volunteer data:', error);
        }
    }

    // Fetch Available Tasks (Only pending)
    async function fetchTasks() {
        try {
            const response = await fetch('http://localhost:3000/api/tasks/pending');
            if (!response.ok) throw new Error('Failed to fetch tasks');

            const tasks = await response.json();
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = tasks.length === 0
                ? 'No tasks available.'
                : tasks.map(task => `
                    <div class="task-card" id="task-${task._id}">
                        <p><strong>Help Needed:</strong> ${task.helpType}</p>
                        <p><strong>Urgency:</strong> ${task.urgency}</p>
                        <p><strong>Location:</strong> ${task.location}</p>
                        <button class="accept-btn" onclick="acceptTask('${task._id}')">Accept</button>
                        <button class="reject-btn" onclick="rejectTask('${task._id}')">Reject</button>
                    </div>
                `).join('');
        } catch (error) {
            console.error('Error fetching tasks:', error);
        }
    }

    // Accept Task
    window.acceptTask = async (taskId) => {
        try {
            const response = await fetch(`http://localhost:3000/api/tasks/${taskId}/accept`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ volunteerId }),
            });

            if (!response.ok) throw new Error('Failed to accept task');
            alert('Task accepted successfully!');

            // Remove accepted task from UI
            document.getElementById(`task-${taskId}`).remove();
        } catch (error) {
            alert('Error accepting task.');
        }
    };

    // Reject Task
    window.rejectTask = async (taskId) => {
        try {
            const response = await fetch(`http://localhost:3000/api/tasks/${taskId}/reject`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ rejectionMessage: 'Task rejected by volunteer.' }),
            });

            if (!response.ok) throw new Error('Failed to reject task');
            alert('Task rejected successfully.');

            // Remove rejected task from UI
            document.getElementById(`task-${taskId}`).remove();
        } catch (error) {
            alert('Error rejecting task.');
        }
    };

    window.logout = () => {
        localStorage.removeItem('userId');
        window.location.href = '../pages/index.html';
    };

    await fetchVolunteerData();
    await fetchTasks();
});


    </script>
</body>

</html>
